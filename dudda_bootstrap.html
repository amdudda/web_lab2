<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Adapted from lab week 2 -->
    <!-- Set page width equal to browser window width -->
    <meta name="viewport" content="width=device-width intial-scale=1" />
    <!-- download bootstrap file -->
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" />

    <! -- also the CSS stylesheet -->
    <link rel="stylesheet" href="dudda_bootstyle.css" type="text/css" />
    <title>Musicology Institute Database</title>

</head>
<body>
<div class="container">
    <div class="jumbotron">
        <p><span class="glyphicon glyphicon-music"></span></p>
        <h1>Java Project:<br>Musicology Institute Database</h1>
        <p>A database for a fictional instrument museum.</p>
        <p><span class="glyphicon glyphicon-music"></span></p>
    </div>
    <div class="row">
    <div class="col-sm-8">
    <p> This was a project I created for my Java class while at MCTC.</p>
        <p>It's coded in Java and uses a MySQL database to store the data.  I've stored the project in a
        <a href="https://github.com/amdudda/MusicologyInstitute">GitHub repository</a></p>
        <p>This snippet is one of my slicker achievements.  I did some searching and figured out how
        to return a new record's primary key so I could store additional data in a child table.  I started
        with a try...catch block and kick off with setting a prepared statement that returns the primary
        key of the inserted record:</p>
        <code>
            try {<br />
            PreparedStatement addInst = Database.conn.prepareStatement(prSt, PreparedStatement.RETURN_GENERATED_KEYS);<br />
        </code>
        <p>Let's skip a bunch of code that gets the statement ready to insert a new instrument into the
            database and ends with...</p>
        <code>
            addInst.executeUpdate();<br />
            /*<br />
            see URL for info on returning the PK generated by the query.<br />
            http://stackoverflow.com/questions/14234257/java-with-sql-the-return-value-of-insert-command#14234362<br />
            */<br />
            getPK = addInst.getGeneratedKeys();<br />
            if (getPK.next()) {<br />
            genPK = getPK.getInt(1);<br />
            }<br />
            // don't forget to close my stuff just in case it's still lingering...<br />
            if (getPK != null) getPK.close();<br />
            if (addInst != null) addInst.close();<br />
            } catch (SQLException sqle) {<br />
            System.out.println("Unable to insert database record.\n" + sqle);<br />
            /* System.out.println("error code:" + sqle.getErrorCode());<br />
            System.out.println("sql state:" + sqle.getSQLState());*/<br />
            }<br />
            <br />
            //        Also insert the location information if it's available<br />
            if (selectedInstrument.getLocationInfo() != null) {<br />
            selectedInstrument.getLocationInfo().setInstID(genPK);<br />
            selectedInstrument.getLocationInfo().updateRecord();<br />
            }<br />
        </code>
        <p>And once we've inserted the main body of data, I end by inserting the location data into the
        appropriate child table, as shown in the last four lines of code above.</p>
    </div>
    <div class="col-sm-4 callout">
        <p>After the class, another student's project inspired me to create a <a href="https://github.com/amdudda/calendar">calendar object</a>.
        This program has a very simple form and a Calendar object that activates with a button
            and lets a user select a date.  When the user submits the date, the text field is
            populated with a java-date-parseable text string.
        </p>
    </div>
    </div>
    <div class="footer col-sm-12">
        &copy; 2016 by A.M. Dudda
        </div>
</body>
</html>